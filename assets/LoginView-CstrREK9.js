import{u as x,x as i,r as t,f as R,o as V,i as r,g as o,l as F,E as v,k as h,_ as S,a as k,b as U}from"./index-Qn6WBdc9.js";import{u as q}from"./gameStore-fGbQL1kf.js";const L={__name:"LoginForm",emits:["login-success"],setup(y,{emit:_}){const d=_,c=x(),g=q(),n=i(null),e=i({username:"",password:""}),p=i({username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}),f=async()=>{try{await n.value.validate();const l=c.login(e.value.username,e.value.password);l.success?(v.success(l.message),g.initGame(),d("login-success")):v.error(l.message)}catch(l){console.log("表单验证失败:",l)}};return(l,s)=>{const a=t("el-input"),m=t("el-form-item"),b=t("el-button"),w=t("el-form");return V(),R(w,{model:e.value,rules:p.value,ref_key:"loginFormRef",ref:n,"label-width":"80px"},{default:r(()=>[o(m,{label:"用户名",prop:"username"},{default:r(()=>[o(a,{modelValue:e.value.username,"onUpdate:modelValue":s[0]||(s[0]=u=>e.value.username=u),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),o(m,{label:"密码",prop:"password"},{default:r(()=>[o(a,{modelValue:e.value.password,"onUpdate:modelValue":s[1]||(s[1]=u=>e.value.password=u),type:"password",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),o(m,null,{default:r(()=>[o(b,{type:"primary",onClick:f},{default:r(()=>[...s[2]||(s[2]=[F("登录",-1)])]),_:1})]),_:1})]),_:1},8,["model","rules"])}}},P={__name:"RegisterForm",emits:["register-success"],setup(y,{emit:_}){const d=_,c=x(),g=h(),n=i(null),e=i({username:"",password:"",confirmPassword:""}),p=i({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:15,message:"用户名长度在 3 到 15 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于 6 个字符",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(l,s,a)=>{s!==e.value.password?a(new Error("两次输入密码不一致!")):a()},trigger:"blur"}]}),f=async()=>{try{await n.value.validate();const l=c.register(e.value.username,e.value.password);l.success?(v.success(l.message),d("register-success"),c.login(e.value.username,e.value.password).success&&g.push("/").catch(a=>{(!a||!a.message||!a.message.includes("Avoided redundant navigation"))&&console.error("导航到主页失败:",a)}),n.value.resetFields()):v.error(l.message)}catch(l){console.log("表单验证失败:",l)}};return(l,s)=>{const a=t("el-input"),m=t("el-form-item"),b=t("el-button"),w=t("el-form");return V(),R(w,{model:e.value,rules:p.value,ref_key:"registerFormRef",ref:n,"label-width":"80px"},{default:r(()=>[o(m,{label:"用户名",prop:"username"},{default:r(()=>[o(a,{modelValue:e.value.username,"onUpdate:modelValue":s[0]||(s[0]=u=>e.value.username=u),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),o(m,{label:"密码",prop:"password"},{default:r(()=>[o(a,{modelValue:e.value.password,"onUpdate:modelValue":s[1]||(s[1]=u=>e.value.password=u),type:"password",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),o(m,{label:"确认密码",prop:"confirmPassword"},{default:r(()=>[o(a,{modelValue:e.value.confirmPassword,"onUpdate:modelValue":s[2]||(s[2]=u=>e.value.confirmPassword=u),type:"password",placeholder:"请确认密码"},null,8,["modelValue"])]),_:1}),o(m,null,{default:r(()=>[o(b,{type:"primary",onClick:f},{default:r(()=>[...s[3]||(s[3]=[F("注册",-1)])]),_:1})]),_:1})]),_:1},8,["model","rules"])}}},B={class:"auth-container"},C={class:"tabs-container"},E={__name:"LoginView",setup(y){const _=h(),d=i("login"),c=()=>{_.push("/").catch(n=>{n.message.includes("Avoided redundant navigation")||console.error("跳转失败:",n)})},g=()=>{d.value="login"};return(n,e)=>{const p=t("el-tab-pane"),f=t("el-tabs"),l=t("el-card");return V(),k("div",B,[o(l,{class:"auth-card"},{default:r(()=>[U("div",C,[o(f,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=s=>d.value=s),type:"border-card"},{default:r(()=>[o(p,{label:"登录",name:"login"},{default:r(()=>[o(L,{onLoginSuccess:c})]),_:1}),o(p,{label:"注册",name:"register"},{default:r(()=>[o(P,{onRegisterSuccess:g})]),_:1})]),_:1},8,["modelValue"])])]),_:1})])}}},A=S(E,[["__scopeId","data-v-9b8b8895"]]);export{A as default};
